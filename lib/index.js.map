{"version":3,"file":"index.js","sources":["../src/directives/table-infinite-scroll.js","../src/index.js"],"sourcesContent":["/**\n * 对 element-ui 的无限滚动在 el-table 上使用的封装\n */\nimport elInfiniteScroll from 'element-ui/lib/infinite-scroll';\n\nconst elScope = 'ElInfiniteScroll'; // scope name\nconst msgTitle = `[el-table-infinite-scroll]: `; // message title\nconst elTableScrollWrapperClass = '.el-table__body-wrapper';\n\nexport default {\n  inserted(el, binding, vnode, oldVnode) {\n    // 获取 table 中的滚动层\n    const scrollElem = el.querySelector(elTableScrollWrapperClass);\n\n    // 如果没找到元素，返回错误\n    if (!scrollElem) {\n      throw `${msgTitle}找不到 ${elTableScrollWrapperClass} 容器`;\n    }\n\n    // 设置自动滚动\n    scrollElem.style.overflowY = 'auto';\n\n    // dom 渲染后\n    setTimeout(() => {\n      if (!scrollElem.style.height) {\n        scrollElem.style.height = '400px';\n        console.warn(\n          `${msgTitle}请尽量设置 el-table 的高度，可以设置为 auto/100%（自适应高度），未设置会取 400px 的默认值（不然会导致一直加载）`\n        );\n      }\n\n      // 绑定 infinite-scroll\n      elInfiniteScroll.inserted(scrollElem, binding, vnode, oldVnode);\n\n      // 将子集的引用放入 el 上，用于 unbind 中销毁事件\n      el[elScope] = scrollElem[elScope];\n    }, 0);\n  },\n  componentUpdated(el, binding, vnode) {\n    asyncElOptions(vnode, el, el.querySelector(elTableScrollWrapperClass));\n  },\n  unbind: elInfiniteScroll.unbind\n};\n\n/**\n * 同步 el-infinite-scroll 的配置项\n * @param sourceVNode\n * @param sourceElem\n * @param targetElem\n */\nfunction asyncElOptions(sourceVNode, sourceElem, targetElem) {\n  const context = sourceVNode.context;\n  let value;\n  ['disabled', 'delay', 'immediate'].forEach((name) => {\n    name = 'infinite-scroll-' + name;\n    value = sourceElem.getAttribute(name);\n    if (value !== null) {\n      targetElem.setAttribute(name, context[value] || value);\n    }\n  });\n\n  // fix: windows/chrome 的 scrollTop + clientHeight 与 scrollHeight 不一致的 BUG\n  const name = 'infinite-scroll-distance';\n  value = context[sourceElem.getAttribute(name)];\n  targetElem.setAttribute(name, value < 1 ? 1 : value);\n}\n","// directive\nimport elTableInfiniteScroll from './directives/table-infinite-scroll';\n\n// Vue.use()\nelTableInfiniteScroll.install = (Vue) => {\n  Vue.directive('el-table-infinite-scroll', elTableInfiniteScroll);\n};\n\n// Vue.component()\nexport default elTableInfiniteScroll;\n"],"names":["elScope","msgTitle","elTableScrollWrapperClass","inserted","el","binding","vnode","oldVnode","scrollElem","querySelector","style","overflowY","setTimeout","height","console","warn","elInfiniteScroll","componentUpdated","asyncElOptions","unbind","sourceVNode","sourceElem","targetElem","context","value","forEach","name","getAttribute","setAttribute","elTableInfiniteScroll","install","Vue","directive"],"mappings":";;;;;;;;;AAKA,IAAMA,OAAO,GAAG,kBAAhB;AACA,IAAMC,QAAQ,iCAAd;AACA,IAAMC,yBAAyB,GAAG,yBAAlC;AAEA,4BAAe;EACbC,QADa,oBACJC,EADI,EACAC,OADA,EACSC,KADT,EACgBC,QADhB,EAC0B;QAE/BC,UAAU,GAAGJ,EAAE,CAACK,aAAH,CAAiBP,yBAAjB,CAAnB;;QAGI,CAACM,UAAL,EAAiB;sBACNP,QAAT,gCAAwBC,yBAAxB;;;IAIFM,UAAU,CAACE,KAAX,CAAiBC,SAAjB,GAA6B,MAA7B;IAGAC,UAAU,CAAC,YAAM;UACX,CAACJ,UAAU,CAACE,KAAX,CAAiBG,MAAtB,EAA8B;QAC5BL,UAAU,CAACE,KAAX,CAAiBG,MAAjB,GAA0B,OAA1B;QACAC,OAAO,CAACC,IAAR,WACKd,QADL;;;MAMFe,gBAAgB,CAACb,QAAjB,CAA0BK,UAA1B,EAAsCH,OAAtC,EAA+CC,KAA/C,EAAsDC,QAAtD;MAGAH,EAAE,CAACJ,OAAD,CAAF,GAAcQ,UAAU,CAACR,OAAD,CAAxB;KAZQ,EAaP,CAbO,CAAV;GAdW;EA6BbiB,gBA7Ba,4BA6BIb,EA7BJ,EA6BQC,OA7BR,EA6BiBC,KA7BjB,EA6BwB;IACnCY,cAAc,CAACZ,KAAD,EAAQF,EAAR,EAAYA,EAAE,CAACK,aAAH,CAAiBP,yBAAjB,CAAZ,CAAd;GA9BW;EAgCbiB,MAAM,EAAEH,gBAAgB,CAACG;CAhC3B;;AAyCA,SAASD,cAAT,CAAwBE,WAAxB,EAAqCC,UAArC,EAAiDC,UAAjD,EAA6D;MACrDC,OAAO,GAAGH,WAAW,CAACG,OAA5B;MACIC,KAAJ;GACC,UAAD,EAAa,OAAb,EAAsB,WAAtB,EAAmCC,OAAnC,CAA2C,UAACC,IAAD,EAAU;IACnDA,IAAI,GAAG,qBAAqBA,IAA5B;IACAF,KAAK,GAAGH,UAAU,CAACM,YAAX,CAAwBD,IAAxB,CAAR;;QACIF,KAAK,KAAK,IAAd,EAAoB;MAClBF,UAAU,CAACM,YAAX,CAAwBF,IAAxB,EAA8BH,OAAO,CAACC,KAAD,CAAP,IAAkBA,KAAhD;;GAJJ;MASME,IAAI,GAAG,0BAAb;EACAF,KAAK,GAAGD,OAAO,CAACF,UAAU,CAACM,YAAX,CAAwBD,IAAxB,CAAD,CAAf;EACAJ,UAAU,CAACM,YAAX,CAAwBF,IAAxB,EAA8BF,KAAK,GAAG,CAAR,GAAY,CAAZ,GAAgBA,KAA9C;;;AC5DFK,qBAAqB,CAACC,OAAtB,GAAgC,UAACC,GAAD,EAAS;EACvCA,GAAG,CAACC,SAAJ,CAAc,0BAAd,EAA0CH,qBAA1C;CADF;;;;"}